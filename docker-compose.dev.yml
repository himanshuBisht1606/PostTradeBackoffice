networks:
  posttrade-observability:
    external: true   # created by docker-compose.signoz.yml

services:
  api:
    image: ghcr.io/himanshubisht1606/posttrade-api:dev-latest
    container_name: posttrade-api-dev
    restart: unless-stopped
    ports:
      - "80:8080"
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ConnectionStrings__DefaultConnection: "Host=${DB_HOST};Port=${DB_PORT};Database=${DB_NAME};Username=${DB_USER};Password=${DB_PASS};SSL Mode=Require;Trust Server Certificate=true"
      Jwt__Key: ${JWT_SECRET_KEY}
      Jwt__Issuer: PostTradeBackoffice
      Jwt__Audience: PostTradeBackoffice
      Jwt__ExpiryMinutes: "60"
      # SigNoz â€” send all telemetry to the OTel Collector running on the same VM
      OpenTelemetry__Endpoint: "http://signoz-otel-collector:4317"
    mem_limit: 700m
    networks:
      - default
      - posttrade-observability
