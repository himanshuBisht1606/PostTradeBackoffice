<clickhouse>
    <logger>
        <level>warning</level>
        <console>true</console>
    </logger>

    <!-- Reduce memory footprint for self-hosted setup -->
    <max_server_memory_usage_to_ram_ratio>0.4</max_server_memory_usage_to_ram_ratio>

    <mark_cache_size>536870912</mark_cache_size>

    <compression>
        <case>
            <method>zstd</method>
        </case>
    </compression>

    <!-- ZooKeeper coordination (required for ReplicatedMergeTree tables used by SigNoz) -->
    <zookeeper>
        <node>
            <host>zookeeper-1</host>
            <port>2181</port>
        </node>
    </zookeeper>

    <!-- Macros for replica identification -->
    <macros>
        <shard>01</shard>
        <replica>01</replica>
    </macros>

    <!-- Allow SigNoz to create its databases -->
    <access_control_improvements>
        <users_without_row_policies_can_read_rows>true</users_without_row_policies_can_read_rows>
    </access_control_improvements>

    <!-- Distributed DDL -->
    <distributed_ddl>
        <path>/clickhouse/task_queue/ddl</path>
    </distributed_ddl>
</clickhouse>
